{"version":3,"sources":["panels/components/Meta.js","panels/Event/EventCard.js","panels/Event/FilterPanel.js","panels/Event/EventCardList.js","panels/components/Rating.js","panels/UserProfile/UserHeader.js","panels/components/EventAdd.js","utils/Filter.js","panels/UserProfile/UserProfile.js","panels/LocationEvents/LocationEvents.js","panels/components/UserSmallCard.js","panels/Event/Event.js","panels/components/EventCreate.js","panels/Main/TabsRoot.js","panels/App.js","routes.js","auth/AuthProvider.js","index.js","create-router.js"],"names":["Meta","name","content","ProjectCard","props","event","router","useRoute","size","onClick","navigate","id","console","log","before","src","user","photo","description","style","display","location","asideContent","price","textAlign","color","margin","Math","round","Date","date","toLocaleDateString","bottomContent","FilterPanel","filterValues","onUpdate","min","max","step","value","onChange","key","top","defaultChecked","e","target","checked","ProjectCardList","events","filter","setFilter","useState","currentModal","setCurrentModal","innerFilter","setInnerFilter","useEffect","filteredEvents","element","filterModal","activeModal","onClose","header","level","dynamicContentHeight","data","modal","separator","map","EventCard","initialRating","Rating","eventId","userId","database","firebase","rating","setRating","a","ref","on","dataSnapshooot","fetchedValue","val","ratingData","item","ids","Object","values","length","fetchData","flexDirection","flex","forEach","index","set","remove","onRate","orderByChild","equalTo","snapshoot","keys","UserHeader","className","disabled","multiline","photo_200","text","weight","first_name","last_name","EventAdd","position","left","bottom","zIndex","background","boxShadow","fill","Filter","args","this","UserProfile","loading","setLoading","fetchedUser","setUser","fetchedEvents","setEvents","bridge","send","nextPage","last","query","orderByKey","startAt","limitToFirst","dataSnapshot","entries","splice","pageStart","threshold","loadMore","hasMore","loader","EventCardList","LocationEvents","setLocation","lat","long","subscribe","detail","type","schemeAttribute","document","createAttribute","scheme","body","attributes","setNamedItem","getDistance","latitude","longitude","lng","alignItems","marginTop","height","padding","defaultState","center","zoom","width","geometry","options","preset","UserSmallCard","mode","href","vkId","after","firstName","lastName","Event","useRouteNode","route","params","propsEvent","setEvent","subscriptions","setSubscriptions","snapshot","window","history","back","right","backgroundImage","justifyContent","paddingBottom","borderRadius","photos","layout","toLocaleString","indexOf","stretched","subscribeUserData","then","EventCreate","eventName","useRef","eventPrice","eventPicture","eventDescription","eventDate","coordinates","userLocation","setUserLocation","userInfo","GEOCODER_URL","process","join","fetch","response","json","GeoObjectCollection","featureMember","GeoObject","submitEvent","createdEvent","push","current","valueAsNumber","picture","get","getRef","controlSize","defaultValue","TABS__","icon","TabsRoot","activeStory","setActiveStory","useRouter","currentTab","tab","tabName","onStoryChange","to","currentTarget","dataset","story","tabBarComponent","selected","data-story","tabbar","dotenv","config","App","path","AuthContext","createContext","AuthProvider","children","vkUser","setVkUser","fetchUser","app","auth","onAuthStateChanged","Provider","createRouter","routes","defaultRoute","usePlugin","browserPlugin","useHash","configureRouter","initializeApp","apiKey","projectId","databaseURL","authDomain","storage","email","password","userUuid","uuidv4","catch","fauth","createUserWithEmailAndPassword","error","code","signInWithEmailAndPassword","logIn","start","ReactDOM","render","getElementById","eruda"],"mappings":"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","file":"static/js/main.2c724a85.chunk.js","sourcesContent":["import React from \"react\";\r\n\r\nconst Meta = () => {\r\n  return (\r\n      <meta\r\n        name=\"viewport\"\r\n        content=\"width=device-width, initial-scale=1, shrink-to-fit=no, user-scalable=no, viewport-fit=cover\"\r\n      ></meta>\r\n  );\r\n};\r\n\r\nexport default Meta;\r\n","import React from \"react\";\r\nimport PropTypes from \"prop-types\";\r\nimport { Card, Cell, Avatar } from \"@vkontakte/vkui\";\r\nimport Icon24User from \"@vkontakte/icons/dist/24/user\";\r\nimport Icon16Place from \"@vkontakte/icons/dist/16/place\";\r\nimport Icon24MoneyCircle from \"@vkontakte/icons/dist/24/money_circle\";\r\nimport { useRoute } from \"react-router5\";\r\n\r\nconst ProjectCard = (props) => {\r\n\r\n  const { event } = props;\r\n  const { router } = useRoute();\r\n\r\n  return (\r\n    <Card size=\"l\" onClick={() => { router.navigate('event', { id: event.id, event }); console.log('card click') }}>\r\n      <Cell\r\n        before={\r\n          <Avatar size={32} src={event.user.photo ?? null}>\r\n            {event.user.photo ? null : <Icon24User />}\r\n          </Avatar>\r\n        }\r\n        size=\"l\"\r\n        description={\r\n          <div style={{ display: \"flex\" }}>\r\n            <Icon16Place />\r\n            {event.location.name}\r\n          </div>\r\n        }\r\n        asideContent={\r\n          <>\r\n            {\r\n              event.price && event.price !== 0 ? (\r\n                <div style={{ textAlign: \"center\", color: \"green\" }}>\r\n                  <Icon24MoneyCircle style={{ margin: \"0 auto\" }} />\r\n                  {Math.round(event.price)}\r\n                </div>\r\n              ) : <></>\r\n            }\r\n            <div>\r\n              {new Date(event.date).toLocaleDateString()}\r\n            </div>\r\n          </>\r\n        }\r\n        bottomContent={\r\n          <>\r\n            <div>{event.description}</div>\r\n          </>\r\n        }\r\n      >\r\n        {event.name}\r\n      </Cell>\r\n    </Card>\r\n  );\r\n};\r\n\r\nProjectCard.propTypes = {\r\n  event: PropTypes.any.isRequired,\r\n};\r\n\r\nexport default ProjectCard;\r\n","import React from \"react\";\r\nimport PropTypes from \"prop-types\";\r\nimport {\r\n  Switch,\r\n  Cell,\r\n  Slider,\r\n  FormLayout\r\n} from \"@vkontakte/vkui\";\r\n\r\nconst FilterPanel = (props) => {\r\n\r\n  const { filterValues, onUpdate } = props;  \r\n\r\n  // TODO : check rerendering here\r\n\r\n  return (\r\n    <FormLayout>\r\n      <Slider\r\n        min={500}\r\n        max={50 * 1000}\r\n        step={500}\r\n        value={filterValues['location'] === null ? 1 : filterValues['location']}\r\n        onChange={(value) => onUpdate({ key: 'location', value: value })}\r\n        top={`–í —Ä–∞–¥–∏—É—Å–µ ${filterValues['location']} –º`}\r\n      />\r\n      <Cell asideContent={<Switch defaultChecked={filterValues['date']} onChange={(e) => onUpdate({ key: 'date', value: e.target.checked })} />}>–°–∫–æ—Ä–æ</Cell>\r\n      <Cell asideContent={<Switch defaultChecked={filterValues['friends']} onChange={(e) => onUpdate({ key: 'friends', value: e.target.checked })} />}>–î—Ä—É–∑—å—è</Cell>\r\n      <Cell></Cell><Cell></Cell>\r\n    </FormLayout>\r\n  )\r\n};\r\n\r\nFilterPanel.propTypes = {\r\n  onUpdate: PropTypes.func.isRequired,\r\n};\r\n\r\nexport default FilterPanel;\r\n","import React, { useState, useEffect } from \"react\";\r\nimport PropTypes from \"prop-types\";\r\nimport {\r\n  Group,\r\n  CardGrid,\r\n  CellButton,\r\n  View,\r\n  ModalRoot,\r\n  ModalPage,\r\n  ModalPageHeader,\r\n  Title,\r\n  Spinner,\r\n  Button,\r\n} from \"@vkontakte/vkui\";\r\n\r\nimport Icon24Sort from \"@vkontakte/icons/dist/24/sort\";\r\n\r\nimport EventCard from \"./EventCard\";\r\nimport FilterPanel from \"./FilterPanel\";\r\n\r\nconst MAIN_MODAL = \"main-modal\";\r\n\r\nconst ProjectCardList = (props) => {\r\n  const { events, filter, setFilter } = props;\r\n  const [currentModal, setCurrentModal] = useState(null);\r\n  const [innerFilter, setInnerFilter] = useState(filter);\r\n\r\n  useEffect(() => {\r\n    setInnerFilter(filter);\r\n  }, [filter]);\r\n\r\n\r\n  const updateFilter = (data) => {\r\n    const { key, value } = data;\r\n    setInnerFilter({\r\n      ...filter,\r\n      [key]: value\r\n    })\r\n  }\r\n\r\n  let filteredEvents = events.filter((element) => {\r\n    return element;\r\n  });\r\n\r\n  const filterModal = (\r\n    <ModalRoot\r\n      activeModal={currentModal}\r\n      onClose={() => {\r\n        setCurrentModal(null);\r\n        setFilter(innerFilter);\r\n        filteredEvents = events.filter((element) => {\r\n          return element;\r\n        });\r\n      }}\r\n    >\r\n      <ModalPage\r\n        id={MAIN_MODAL}\r\n        header={<ModalPageHeader><Title level=\"2\">–§–∏–ª—å—Ç—Ä—ã</Title></ModalPageHeader>}\r\n        dynamicContentHeight\r\n      >\r\n        <FilterPanel filterValues={innerFilter} onUpdate={updateFilter} />\r\n      </ModalPage>\r\n    </ModalRoot>\r\n  );\r\n\r\n  return (\r\n    <View modal={filterModal}>\r\n      <Group\r\n        separator=\"hide\"\r\n        header={\r\n          <CellButton\r\n            before={<Icon24Sort />}\r\n            onClick={() => {\r\n              setCurrentModal(MAIN_MODAL);\r\n            }}\r\n          >\r\n            –§–∏–ª—å—Ç—Ä–æ–≤–∞—Ç—å\r\n          </CellButton>\r\n        }\r\n      >\r\n        <CardGrid>\r\n          {filteredEvents.map((event, key) => (\r\n            <EventCard key={key} event={event} />\r\n          ))}\r\n        </CardGrid>\r\n      </Group>\r\n    </View>\r\n  );\r\n};\r\n\r\nProjectCardList.propTypes = {\r\n  events: PropTypes.array.isRequired,\r\n  filter: PropTypes.object.isRequired,\r\n  setFilter: PropTypes.func.isRequired\r\n};\r\n\r\nexport default ProjectCardList;\r\n","import React, { useEffect, useState } from \"react\";\r\nimport {\r\n  Div,\r\n  Title\r\n} from \"@vkontakte/vkui\";\r\nimport firebase from \"firebase\";\r\nimport \"firebase/database\";\r\n\r\nexport const initialRating = [\r\n  { key: \"üòä\", value: [] },\r\n  { key: \"üò¥\", value: [] },\r\n  { key: \"üòç\", value: [] },\r\n  { key: \"ü§¨\", value: [] },\r\n];\r\n\r\nconst Rating = (props) => {\r\n\r\n  const { eventId, userId } = props;\r\n\r\n  const database = firebase.database();\r\n\r\n  const [rating, setRating] = useState([]);\r\n\r\n  useEffect(() => {\r\n    const fetchData = async () => {\r\n      database.ref(`rating/${eventId}`).on(\"value\", dataSnapshooot => {\r\n        const fetchedValue = dataSnapshooot.val();\r\n        const ratingData = fetchedValue ? fetchedValue.map(item => {\r\n          return {\r\n            key: item.key,\r\n            value: item.ids ? Object.values(item.ids).length : 0\r\n          };\r\n        }) : initialRating;\r\n        setRating(ratingData);\r\n      });\r\n    };\r\n    fetchData();\r\n  }, [database]);\r\n\r\n  const onRate = (key) => {\r\n    rating.forEach((element, index) => {\r\n      if (element.key === key) {\r\n        database.ref(`rating/${eventId}/${index}/ids/${userId}`).set(true);\r\n      } else {\r\n        database.ref(`rating/${eventId}/${index}/ids/${userId}`).remove();\r\n      }\r\n    });\r\n  }\r\n\r\n  if (!eventId) {\r\n    // User profile rating\r\n    database.ref(`events`).orderByChild('user/vkId').equalTo(userId ?? 0).on(\"value\", snapshoot => {\r\n      console.log(snapshoot.val() ? Object.keys(snapshoot.val()) : `NO EVENTS FOR ${userId}`);\r\n    });\r\n    return <></>;\r\n  }\r\n\r\n  return (\r\n    <Div style={{ display: \"flex\" }}>\r\n      {(rating ? rating : initialRating).map((item, key) => (\r\n        <Div key={key} style={{ display: \"flex\", flexDirection: \"column\", flex: 1 }} onClick={() => onRate(item.key)}>\r\n          <Title level={item.set ? \"1\" : \"2\"} style={{ textAlign: \"center\" }}>{item.key}</Title>\r\n          <Title level={item.set ? \"2\" : \"3\"} style={{ textAlign: \"center\" }}>{item.value}</Title>\r\n        </Div>\r\n      ))}\r\n    </Div>\r\n  )\r\n};\r\n\r\nexport default Rating;\r\n","import React from \"react\";\nimport { Avatar, RichCell, Title } from \"@vkontakte/vkui\";\nimport PropTypes from \"prop-types\";\n\nimport Icon24User from \"@vkontakte/icons/dist/24/user\";\n\nimport Rating from \"../components/Rating\";\nimport \"./UserProfile.css\";\n\nconst UserHeader = (props) => {\n\n  const { user } = props;\n  const userName = \"–ù–∏–∫–∏—Ç–∞ –î–æ–ª–≥–æ—à–µ–∏–Ω\";\n\n  console.log(\"User : \", user);\n\n  return (\n    <RichCell\n      className=\"user-profile-header\"\n      disabled\n      multiline\n      before={\n        <Avatar\n          size={72}\n          src={user !== null ? user.photo_200 : null}\n        >\n          {user === null ? <Icon24User /> : null}\n        </Avatar>\n      }\n      text={ \"Rating here soon\"\n      }\n    >\n      <Title level=\"2\" weight=\"regular\">\n        {user !== null\n          ? `${user.first_name} ${user.last_name}`\n          : userName}\n      </Title>\n    </RichCell>\n  );\n};\n\nUserHeader.propTypes = {\n  rating: PropTypes.array,\n  user: PropTypes.object\n}\n\nexport default UserHeader;\n","import React from \"react\";\nimport Icon28AddOutline from \"@vkontakte/icons/dist/28/add_outline\";\nimport { Avatar } from \"@vkontakte/vkui\";\nimport { useRoute } from \"react-router5\";\n\nconst EventAdd = () => {\n\n  const { router } = useRoute();\n\n  return (\n    <div\n      style={{ position: \"fixed\", left: 24, bottom: 64, zIndex: 100 }}\n      onClick={() => router.navigate('create') }\n    >\n      <Avatar style={{ background: \"var(--button_primary_background)\" , boxShadow: \"0px 0px 10px black\"}}>\n        <Icon28AddOutline fill={\"var(--button_primary_foreground)\"} />\n      </Avatar>\n    </div>\n  );\n\n};\n\nexport default EventAdd;\n","class Filter {\n    constructor(location, date, args) {\n        this.location = location;\n        this.date = date;\n    }\n    update(element) {\n        this[element.key] = element.value;\n    }\n}\n\nexport default Filter;","import React, { useState, useEffect } from \"react\";\r\nimport { Panel, PanelSpinner, Spinner } from \"@vkontakte/vkui\";\r\nimport bridge from \"@vkontakte/vk-bridge\";\r\nimport firebase from \"firebase/app\";\r\nimport \"firebase/database\";\r\n\r\nimport \"./UserProfile.css\";\r\nimport EventCardList from \"../Event/EventCardList\";\r\nimport UserHeader from \"./UserHeader\";\r\nimport EventAdd from \"../components/EventAdd\";\r\nimport Filter from \"../../utils/Filter\";\r\nimport InfiniteScroll from 'react-infinite-scroller';\r\n\r\nconst UserProfile = (props) => {\r\n\r\n  // TODO : here we can render user related data first\r\n\r\n  // Fetch data\r\n  const database = firebase.database();\r\n  const [loading, setLoading] = useState(true);\r\n\r\n  const [fetchedUser, setUser] = useState(null);\r\n  const [fetchedEvents, setEvents] = useState([]);\r\n  const [filter, setFilter] = useState(new Filter(0, null));\r\n\r\n  /*\r\n  Fetch VK user data and save it to state.\r\n  */\r\n  useEffect(() => {\r\n    async function fetchData() {\r\n      const user = await bridge.send(\"VKWebAppGetUserInfo\");\r\n      setUser(user);\r\n    }\r\n    fetchData();\r\n  }, [database]);\r\n\r\n  /*\r\n  Fetch events from firebase.\r\n  */\r\n  // TODO : make it work with filter\r\n  // may be it is better just to move all the logic inside EventList component\r\n  const nextPage = () => {\r\n    let last = fetchedEvents[fetchedEvents.length - 1];\r\n    let query = database.ref(\"events\").orderByKey();\r\n    if (fetchedEvents.length > 0) {\r\n      query = query.startAt(last.id);\r\n    }\r\n    query.limitToFirst(3).on(\"value\", dataSnapshot => {\r\n      let events = dataSnapshot.val() ? Object.entries(dataSnapshot.val()).map(e => {\r\n        return { id: e[0], ...e[1] };\r\n      }) : []; if (fetchedEvents.length > 0) events.splice(0, 1);\r\n      //console.log(\"next page : \", events);\r\n      if (events.length > 0) {\r\n        setEvents([...fetchedEvents, ...events]);\r\n      } else if (loading) {\r\n        setLoading(false);\r\n      }\r\n    });\r\n  }\r\n\r\n  useEffect(() => {\r\n    nextPage();\r\n  }, [database]);\r\n\r\n  return (\r\n    <Panel>\r\n      <UserHeader user={fetchedUser} />\r\n      <InfiniteScroll pageStart={0} threshold={0} loadMore={nextPage} hasMore={loading} loader={<Spinner key={0} />}>\r\n        <EventCardList events={fetchedEvents} filter={filter} setFilter={setFilter} />\r\n      </InfiniteScroll>\r\n      <EventAdd />\r\n    </Panel>\r\n  );\r\n};\r\n\r\nexport default UserProfile;\r\n","import React, { useState, useEffect } from \"react\";\nimport { Panel, Spinner, Div } from \"@vkontakte/vkui\";\nimport bridge from \"@vkontakte/vk-bridge\";\nimport firebase from \"firebase/app\";\nimport { getDistance } from \"geolib\";\n\nimport { YMaps, Map, Placemark, Circle } from 'react-yandex-maps';\n\nimport EventCardList from \"../Event/EventCardList\";\nimport Filter from \"../../utils/Filter\";\n\nconst LocationEvents = (props) => {\n\n  // Fetch data\n  const database = firebase.database();\n  const [loading, setLoading] = useState(true);\n\n  const [fetchedEvents, setEvents] = useState([]);\n  const [location, setLocation] = useState([56.85, 60.6]);\n  const [filter, setFilter] = useState(new Filter(0, null));\n\n  useEffect(() => {\n    bridge.subscribe(({ detail: { type, data } }) => {\n      if (type === \"VKWebAppUpdateConfig\") {\n        const schemeAttribute = document.createAttribute(\"scheme\");\n        schemeAttribute.value = data.scheme ? data.scheme : \"client_light\";\n        document.body.attributes.setNamedItem(schemeAttribute);\n      }\n    });\n    async function fetchData() {\n      const location = await bridge.send(\"VKWebAppGetGeodata\");\n      setLocation([location.lat, location.long]);\n    }\n    fetchData();\n  }, []);\n\n\n  useEffect(() => {\n    function fetchEvents() {\n      // Events data\n      database.ref(\"events\").on(\"value\", dataSnapshot => {\n        const events = Object.entries(dataSnapshot.val()).map(e => {\n          return { id: e[0], ...e[1] };\n        });\n        setEvents(events);\n        setLoading(false);\n      });\n    }\n    fetchEvents();\n  }, [database]);\n\n  // Fetched here\n  const filteredEvents = fetchedEvents.filter(event => {\n    if (filter['location']) {\n      // TODO : fix incorrect distance calculation.\n      const distanceFromMe = getDistance(\n        { latitude: event.location.lat, longitude: event.location.lng },\n        { latitude: location[1], longitude: location[0] }\n      );\n      if (distanceFromMe <= filter.location)\n        return true;\n    }\n    return false;\n  });\n\n  // Display loading animation\n  if (loading)\n    return (\n      <div\n        style={{\n          display: \"flex\",\n          alignItems: \"center\",\n          flexDirection: \"column\",\n        }}\n      >\n        <Spinner size=\"large\" style={{ marginTop: 20 }} />\n      </div>\n    );\n\n  return (\n    <Panel>\n      <Div style={{ height: \"240px\", padding: 0 }}>\n        <YMaps >\n          <Map defaultState={{ center: location, zoom: 10 }} width={'100%'}>\n            <Placemark geometry={location} options={{ preset: \"islands#redCircleDotIcon\" }} />\n            {\n              filteredEvents.map((event, id) => {\n                const geometry = [event.location.lng, event.location.lat];\n                return (<Placemark key={id} geometry={geometry} />)\n              })\n            }\n            <Circle geometry={[location, filter['location'] /*metrs*/]} />\n          </Map>\n        </YMaps>\n      </Div>\n      <EventCardList events={filteredEvents} filter={filter} setFilter={setFilter} />\n    </Panel>\n  );\n};\n\nexport default LocationEvents;\n","import React from \"react\";\nimport PropTypes from \"prop-types\";\n\nimport { Group, Header, SimpleCell, Avatar } from \"@vkontakte/vkui\";\n\nconst UserSmallCard = (props) => {\n\n  const { user } = props;\n\n  return (\n    <Group>\n      <Header mode=\"secondary\">–û—Ä–≥–∞–Ω–∏–∑–∞—Ç–æ—Ä</Header>\n      <a href={`https://vk.com/id${user.vkId}`}>\n        <SimpleCell before={<Avatar size={40} src={user.photo} after={\"textz\"} />}>{`${user.firstName} ${user.lastName}`}</SimpleCell>\n      </a>\n    </Group>\n  );\n}\n\nUserSmallCard.propTypes = {\n  user: PropTypes.any.isRequired,\n};\n\nexport default UserSmallCard;\n","import React, { useEffect, useState } from \"react\";\r\nimport { useRouteNode } from \"react-router5\";\r\nimport { PanelHeaderButton, Panel, PanelHeader, Spinner, Div, Cell, Button, Group, Header, UsersStack } from \"@vkontakte/vkui\";\r\nimport Icon24Back from \"@vkontakte/icons/dist/24/back\";\r\nimport Icon24MoneyCircle from \"@vkontakte/icons/dist/24/money_circle\";\r\nimport Icon28QrCodeOutline from '@vkontakte/icons/dist/28/qr_code_outline';\r\nimport Icon24Recent from '@vkontakte/icons/dist/24/recent';\r\nimport { YMaps, Map, Placemark } from \"react-yandex-maps\";\r\nimport firebase from \"firebase\";\r\nimport bridge from \"@vkontakte/vk-bridge\";\r\nimport UserSmallCard from \"../components/UserSmallCard\";\r\nimport Rating from \"../components/Rating\";\r\n\r\nconst Event = () => {\r\n  const { route } = useRouteNode('event');\r\n\r\n  const { id, event: propsEvent } = route.params;\r\n  const [event, setEvent] = useState(propsEvent);\r\n  const [user, setUser] = useState();\r\n  const [subscriptions, setSubscriptions] = useState({});\r\n\r\n  const database = firebase.database();\r\n\r\n  useEffect(() => {\r\n    if (!propsEvent) {\r\n      database.ref(`events/${id}`).on(\"value\", snapshot => {\r\n        setEvent(snapshot.val());\r\n      });\r\n    }\r\n    database.ref(`subscriptions/${id}`).on(\"value\", snapshot => {\r\n      setSubscriptions(snapshot.val());\r\n    });\r\n  }, [database, id, propsEvent]);\r\n\r\n  useEffect(() => {\r\n    const fetchData = async () => {\r\n      const user = await bridge.send(\"VKWebAppGetUserInfo\");\r\n      setUser(user);\r\n    }\r\n    fetchData();\r\n  }, []);\r\n\r\n  if (!event) {\r\n    return <Spinner size=\"large\" />\r\n  }\r\n\r\n  const onDeleteEvent = () => {\r\n    database.ref(`events/${id}`).remove().then(() => {\r\n      console.log(\"Event removed\");\r\n      database.ref(`subscriptions/${id}`).remove().then(() => {\r\n        console.log(\"Subscriptions removed\");\r\n        window.history.back();\r\n      });\r\n    });\r\n  }\r\n\r\n  const onSubscribeEvent = () => {\r\n    const subscribeUserData = {\r\n      firstName: user.first_name,\r\n      lastName: user.last_name,\r\n      photo: user.photo_200\r\n    };\r\n    database.ref(`subscriptions/${id}/${user.id}`).set(subscribeUserData);\r\n  }\r\n\r\n  const onUnsubscribeEvent = () => {\r\n    database.ref(`subscriptions/${id}/${user.id}`).remove();\r\n  }\r\n\r\n  console.log(\"USER is : \", user);\r\n\r\n  return (\r\n    <Panel id={id}>\r\n      <PanelHeader\r\n        left={\r\n          <PanelHeaderButton onClick={() => { window.history.back(); }}>\r\n            <Icon24Back />\r\n          </PanelHeaderButton>\r\n        }\r\n        right={\r\n          <PanelHeaderButton onClick={() => { /* TODO : show QR here. */ }}>\r\n            <Icon28QrCodeOutline />\r\n          </PanelHeaderButton>\r\n        }\r\n      >\r\n        <h5>{event.name}</h5>\r\n      </PanelHeader>\r\n\r\n      {\r\n        <Rating eventId={id} userId={user ? user.id : \"dorianmood\"} />\r\n      }\r\n\r\n      <Div style={{ height: \"240px\", padding: 0 }}>\r\n        <YMaps>\r\n          <Map defaultState={{ center: [event.location.lng, event.location.lat], zoom: 10 }} width={'100%'}>\r\n            <Placemark geometry={[event.location.lng, event.location.lat]} options={{ preset: \"islands#geolocationIcon\" }} />\r\n          </Map>\r\n        </YMaps>\r\n      </Div>\r\n\r\n      <Group header={<Header mode=\"secondary\">–û–ø–∏—Å–∞–Ω–∏–µ</Header>}>\r\n        <Cell multiline size=\"l\">\r\n          {event.description}\r\n        </Cell>\r\n      </Group>\r\n\r\n      <UserSmallCard user={event.user} />\r\n\r\n      <Group header={<Header mode=\"secondary\">–ò–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è</Header>}>\r\n        <Div>\r\n          <div style={{\r\n            backgroundImage: \"url(https://api.parkseason.ru/images/styles/1200_500/d2/af/30e62fddc14c05988b44e7c02788e18759dce9c49e9cc281915310.jpg)\",\r\n            height: \"200px\",\r\n            display: \"flex\",\r\n            alignItems: \"flex-end\",\r\n            justifyContent: \"center\",\r\n            paddingBottom: \"6px\",\r\n            borderRadius: 12\r\n          }}>\r\n            {\r\n              subscriptions ?\r\n                <UsersStack\r\n                  photos={Object.keys(subscriptions).map(key => subscriptions[key].photo)}\r\n                  size=\"m\"\r\n                  layout=\"vertical\"\r\n                  style={{ color: \"#fff\" }}\r\n                >{Object.keys(subscriptions).length} —É—á–∞—Å—Ç–Ω–∏–∫–æ–≤</UsersStack>\r\n                : <></>\r\n            }\r\n          </div>\r\n        </Div>\r\n        <Div style={{ display: \"flex\" }}>\r\n          <Div style={{ flex: \"1 1 auto\", display: \"flex\", justifyContent: \"center\" }}><Icon24MoneyCircle style={{ margin: \"-2px 10px 0 0\" }} fill={\"green\"} /> {event.price}</Div>\r\n          <Div style={{ flex: \"1 1 auto\", display: \"flex\", justifyContent: \"center\" }}><Icon24Recent style={{ margin: \"-2px 10px 0 0\" }} />{new Date(event.date).toLocaleString()}</Div>\r\n        </Div>\r\n\r\n        {\r\n          user && event.user.vkId === user.id ? <></> :\r\n            user && subscriptions && Object.keys(subscriptions).indexOf(`${user.id}`) !== -1 ?\r\n              <Div>\r\n                <Button stretched mode=\"outline\" style={{ padding: \"10px\" }} onClick={onUnsubscribeEvent}>–ù–µ –ø–æ–π–¥—É</Button>\r\n              </Div>\r\n              :\r\n              <Div>\r\n                <Button stretched mode=\"commerce\" style={{ padding: \"10px\" }} onClick={onSubscribeEvent}>–ü–æ–π–¥—É</Button>\r\n              </Div>\r\n        }\r\n        { // TODO : give permission to delete only to owners.\r\n          user && user.id === event.user.vkId ?\r\n            <Div>\r\n              <Button stretched mode=\"destructive\" style={{ padding: \"10px\" }} onClick={onDeleteEvent}>–£–¥–∞–ª–∏—Ç—å</Button>\r\n            </Div> : <></>\r\n        }\r\n      </Group>\r\n    </Panel>\r\n  );\r\n};\r\n\r\nexport default Event;\r\n","import React, { useState, useEffect, useRef } from \"react\";\nimport {\n  Panel,\n  PanelHeader,\n  PanelHeaderButton,\n  Div,\n  Input,\n  Button,\n  FormLayout,\n  FormLayoutGroup,\n  Textarea,\n  File\n} from \"@vkontakte/vkui\";\nimport Icon24Back from \"@vkontakte/icons/dist/24/back\";\nimport Icon24Camera from \"@vkontakte/icons/dist/24/camera\";\nimport { YMaps, Placemark, Map } from \"react-yandex-maps\";\nimport bridge from \"@vkontakte/vk-bridge\";\nimport firebase from \"firebase/app\";\n\nimport { initialRating } from \"../components/Rating\";\n\nconst EventCreate = () => {\n  // TODO : fix rerendering here\n\n  const [user, setUser] = useState({\n    vkId: \"dorianmood\",\n    photo: \"\",\n    firstName: \"Developer\",\n    lastName: \"Developer\"\n  });\n\n  const database = firebase.database();\n\n  // form refs to get rid of rerendering\n  const eventName = useRef();\n  const eventPrice = useRef();\n  const eventPicture = useRef();\n  const eventDescription = useRef();\n  const eventDate = useRef();\n\n  const [location, setLocation] = useState({\n    name: \"–ú–µ—Å—Ç–æ\",\n    coordinates: [56.83890, 60.605192]\n  });\n  const [userLocation, setUserLocation] = useState([56.83890, 60.605192]);\n\n  useEffect(() => {\n    async function fetchData() {\n      const location = await bridge.send(\"VKWebAppGetGeodata\");\n      setUserLocation([location.lat, location.long]);\n      const userInfo = await bridge.send(\"VKWebAppGetUserInfo\");\n      setUser({ vkId: userInfo.id, photo: userInfo.photo_200, firstName: userInfo.first_name, lastName: userInfo.last_name })\n    }\n    fetchData();\n  }, []);\n\n  useEffect(() => {\n    const GEOCODER_URL = `https://geocode-maps.yandex.ru/1.x/?apikey=${process.env.REACT_APP_YANDEX_KEY}&geocode=${[location.coordinates[1], location.coordinates[0]].join(',')}&format=json`;\n\n    fetch(GEOCODER_URL).then(response => response.json()).then(data => {\n      setLocation({\n        ...location,\n        name: data.response.GeoObjectCollection.featureMember[0].GeoObject.name\n      });\n    });\n  }, [location.coordinates]);\n\n  const submitEvent = async () => {\n    // Create event\n    const createdEvent = database.ref(`events`).push(\n      {\n        name: eventName.current.value,\n        price: eventPrice.current.value,\n        date: eventDate.current.valueAsNumber,\n        picture: \"\",\n        description: eventDescription.current.value,\n        location: {\n          name: location.name,\n          lng: location.coordinates[0],\n          lat: location.coordinates[1]\n        },\n        user: user\n      }\n    );\n    // TODO : need fix here. something goes wrong.\n    // Subscribe\n    database.ref(`subscriptions/${createdEvent.key}`).set({\n      firstName: user.firstName,\n      lastName: user.lastName,\n      photo: user.photo\n    }).then(() => console.log(\"SUBSCRIBTION CREATED\"));\n    // Create rating\n    database.ref(`rating/${createdEvent.key}`).set(\n      initialRating.map(item => { return { key: item.key } })\n    ).then(() => console.log(\"RATING CREATED\"));\n  }\n\n  const onSubmit = () => {\n    submitEvent().then(() => {\n      window.history.back();\n    });\n  }\n\n  return (\n    <Panel>\n      <PanelHeader\n        left={\n          <PanelHeaderButton onClick={() => { window.history.back(); }}>\n            {<Icon24Back />}\n          </PanelHeaderButton>\n        }\n      >\n        –û–ø–∏—à–∏—Ç–µ —Å–æ–±—ã—Ç–∏–µ\n      </PanelHeader>\n\n\n      <FormLayout>\n        <FormLayoutGroup top={location.name}>\n          <Div style={{ height: \"150px\" }}>\n            <YMaps>\n              <Map\n                defaultState={{ center: location.coordinates, zoom: 10 }}\n                height={'150px'} width={'100%'}\n                onClick={(e) => { setLocation({ ...location, coordinates: e.get('coords') }) }}\n              >\n                <Placemark geometry={userLocation} options={{ preset: \"islands#redCircleDotIcon\" }} />\n                <Placemark geometry={location.coordinates} />\n              </Map>\n            </YMaps>\n          </Div>\n        </FormLayoutGroup>\n\n        <Input top=\"–ù–∞–∑–≤–∞–Ω–∏–µ\" getRef={eventName} />\n        <File top=\"–ó–∞–≥—Ä—É–∑–∏—Ç–µ —Ñ–æ—Ç–æ\" getRef={eventPicture} before={<Icon24Camera />} controlSize=\"l\">\n          –û—Ç–∫—Ä—ã—Ç—å –≥–∞–ª–µ—Ä–µ—é\n        </File>\n        <Input top=\"–î–∞—Ç–∞\" getRef={eventDate} type=\"datetime-local\" />\n        <Input top=\"–¶–µ–Ω–∞\" getRef={eventPrice} type=\"number\" defaultValue={0} />\n        <Textarea top=\"–û–ø–∏—Å–∞–Ω–∏–µ\" getRef={eventDescription} defaultValue={0} />\n\n        <Button size=\"xl\" onClick={onSubmit}>–°–æ–∑–¥–∞—Ç—å</Button>\n\n      </FormLayout>\n    </Panel>\n  );\n\n};\n\nexport default EventCreate;\n","import React, { useState, useEffect } from \"react\";\r\nimport { useRouter, useRoute } from \"react-router5\";\r\nimport View from \"@vkontakte/vkui/dist/components/View/View\";\r\nimport \"@vkontakte/vkui/dist/vkui.css\";\r\nimport { Tabbar, TabbarItem, Epic } from \"@vkontakte/vkui\";\r\n\r\nimport Icon28BombOutline from \"@vkontakte/icons/dist/28/bomb_outline\";\r\nimport Icon28PlaceOutline from \"@vkontakte/icons/dist/28/place_outline\";\r\n\r\nimport UserProfile from \"../UserProfile/UserProfile\";\r\nimport LocationEvents from \"../LocationEvents/LocationEvents\";\r\nimport Event from \"../Event/Event\";\r\nimport EventCreate from \"../components/EventCreate\";\r\n\r\nconst TABS__ = [\r\n  {\r\n    id: \"me\",\r\n    text: \"–ú–æ–∏\",\r\n    icon: <Icon28BombOutline />\r\n  },\r\n  {\r\n    id: \"location\",\r\n    text: \"–†—è–¥–æ–º\",\r\n    icon: <Icon28PlaceOutline />\r\n  }\r\n]\r\n\r\nconst TabsRoot = () => {\r\n  const { route } = useRoute();\r\n  const [activeStory, setActiveStory] = useState(null);\r\n  const router = useRouter();\r\n  const currentTab = TABS__.filter(tab => tab.id === route.name)[0];\r\n  const tabName = currentTab ? currentTab.id : TABS__[0].id;\r\n\r\n  useEffect(() => {\r\n    setActiveStory(tabName);\r\n  }, [tabName]);\r\n\r\n  if (route.name === \"event\") {\r\n    return (\r\n      <Event />\r\n    );\r\n  } else if (route.name === \"create\") {\r\n    return (\r\n      <EventCreate />\r\n    );\r\n  }\r\n\r\n\r\n  const onStoryChange = (e) => {\r\n    const to = e.currentTarget.dataset.story;\r\n    router.navigate(to);\r\n    setActiveStory(to);\r\n  };\r\n\r\n  const tabBarComponent = (\r\n    <Tabbar>\r\n      {TABS__.map((element, index) =>\r\n        <TabbarItem\r\n          onClick={onStoryChange}\r\n          selected={activeStory === element.id}\r\n          data-story={element.id}\r\n          text={element.text}\r\n          key={index}\r\n        >\r\n          {element.icon}\r\n        </TabbarItem>\r\n      )}\r\n    </Tabbar>\r\n  );\r\n\r\n  return (\r\n    <Epic\r\n      activeStory={activeStory}\r\n      tabbar={\r\n        tabBarComponent\r\n      }\r\n    >\r\n      <View id=\"me\" key=\"0\">\r\n        <UserProfile />\r\n      </View>\r\n      <View id=\"location\" key=\"1\">\r\n        <LocationEvents />\r\n      </View>\r\n    </Epic>\r\n  );\r\n};\r\n\r\nexport default TabsRoot;\r\n","import React from \"react\";\nimport \"@vkontakte/vkui/dist/vkui.css\";\nimport dotenv from \"dotenv\";\n\nimport Meta from \"./components/Meta\";\nimport TabsRoot from \"./Main/TabsRoot\";\n\ndotenv.config();\n\nconst App = () => {\n\n  return (\n    <>\n      <Meta />\n\n      <TabsRoot />\n    </>\n  );\n};\n\nexport default App;\n","export default [\r\n  { name: \"main\", path: \"/\" },\r\n  { name: \"me\", path: \"/me\" },\r\n  { name: \"friends\", path: \"/friends\" },\r\n  { name: \"location\", path: \"/location\" },\r\n  { name: \"event\", path: \"/event/:id\" },\r\n  { name: \"user\", path: \"/user/:id\" },\r\n  { name: \"create\", path: \"/create\" }\r\n];\r\n","import React, { createContext, useState, useEffect } from \"react\";\nimport firebase from \"firebase\";\nimport bridge from \"@vkontakte/vk-bridge\";\n\nexport const AuthContext = createContext();\n\nconst defaultUser = {\n  id: \"dorianmood\",\n  \n}\n\nconst AuthProvider = ({ children }) => {\n\n  const [user, setUser] = useState();\n  const [vkUser, setVkUser] = useState();\n\n  useEffect(() => {\n    const fetchUser = async () => {\n      const user = await bridge.send(\"VKWebAppGetUserInfo\");\n      console.log(\"USER AUTH : \", user);\n\n      setVkUser(user);\n    }\n    fetchUser();\n  }, []);\n\n  useEffect(() => {\n    const app = firebase.app();\n    app.auth().onAuthStateChanged((user) => {\n      setUser(user);\n    })\n  }, []);\n\n  console.log(\"USER AUTH : \", vkUser);\n\n  return (\n    <AuthContext.Provider value={user}>\n      {children}\n    </AuthContext.Provider>\n  );\n}\n\nexport default AuthProvider;","import \"core-js/features/map\";\nimport \"core-js/features/set\";\n\nimport React from \"react\";\nimport ReactDOM from \"react-dom\";\n\nimport { RouterProvider } from \"react-router5\";\n\nimport bridge from \"@vkontakte/vk-bridge\";\n\nimport firebase from \"firebase/app\";\nimport \"firebase/auth\";\n\nimport { v4 as uuidv4 } from \"uuid\";\n\nimport App from \"./panels/App\";\nimport configureRouter from \"./create-router\";\nimport AuthProvider from \"./auth/AuthProvider\";\n\n// Init VK  Mini App\nbridge.send(\"VKWebAppInit\");\n\nconst router = configureRouter();\n\n// Firebase Config\nconst config = {\n  apiKey: process.env.REACT_APP_API_KEY,\n  projectId: process.env.REACT_APP_PROJECT_ID,\n  databaseURL: process.env.REACT_APP_DATABASE_URL,\n  authDomain: process.env.REACT_APP_AUTH_DOMAIN\n};\nfirebase.initializeApp(config);\n\n// TODO : secure api keys\n\nconst logIn = async () => {\n  const storage = await bridge.send(\"VKWebAppStorageGet\", {\n    keys: [\n      \"userUuid\"\n    ]\n  });\n  const user = await bridge.send(\"VKWebAppGetUserInfo\");\n\n  let email = user.id;\n  let password = storage.keys[0].value;\n\n  // For new users generate and\n  // save unique userId here\n  if (!password) {\n    const userUuid = uuidv4();\n    password = userUuid;\n    await bridge\n      .send(\"VKWebAppStorageSet\", { key: \"userUuid\", value: userUuid })\n      .catch(e => console.log(e));\n  }\n\n  let fauth = firebase.auth();\n\n  fauth.createUserWithEmailAndPassword(`${email}@vk.com`, password).then((e) => {\n    console.log(\"create user : OK\");\n  }).catch((e) => {\n    console.error(e.code);\n  }).then(() => {\n    fauth.signInWithEmailAndPassword(`${email}@vk.com`, password).then((e) => {\n      console.log(\"login : OK\");\n    }).catch((e) => {\n      console.log(e.code);\n    })\n  });\n}\n\nlogIn();\n\nrouter.start(() => {\n  ReactDOM.render(\n    <AuthProvider>\n      <RouterProvider router={router}>\n        <App router={router} />\n      </RouterProvider>\n    </AuthProvider>\n    ,\n    document.getElementById(\"root\")\n  );\n});\n\n//if (process.env.NODE_ENV === \"development\") {\nimport(\"./eruda\").then((eruda) => { }); //runtime download\n//}\n","import createRouter from \"router5\";\r\nimport browserPlugin from \"router5-plugin-browser\";\r\nimport routes from \"./routes\";\r\n\r\nexport default function configureRouter() {\r\n  const router = createRouter(routes, {\r\n    defaultRoute: \"me\",\r\n  });\r\n\r\n  router.usePlugin(\r\n    browserPlugin({\r\n      useHash: true,\r\n    })\r\n  );\r\n\r\n  return router;\r\n}\r\n"],"sourceRoot":""}