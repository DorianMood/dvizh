{"version":3,"sources":["panels/components/Meta.js","panels/Event/EventCard.js","panels/Event/FilterPanel.js","panels/Event/EventCardList.js","panels/components/Rating.js","panels/UserProfile/UserHeader.js","panels/components/EventAdd.js","utils/Filter.js","panels/components/EventScan.js","panels/UserProfile/UserProfile.js","panels/LocationEvents/LocationEvents.js","panels/components/UserSmallCard.js","panels/Event/Event.js","panels/components/EventCreate.js","panels/Main/TabsRoot.js","panels/App.js","routes.js","auth/AuthProvider.js","index.js","create-router.js"],"names":["Meta","name","content","ProjectCard","props","event","router","useRoute","size","onClick","navigate","id","before","src","user","photo","description","style","display","location","asideContent","price","textAlign","color","margin","Math","round","Date","date","toLocaleDateString","bottomContent","FilterPanel","filterValues","onUpdate","zIndex","min","max","step","value","onChange","key","top","ProjectCardList","events","filter","setFilter","useState","currentModal","setCurrentModal","innerFilter","setInnerFilter","useEffect","filteredEvents","element","filterModal","activeModal","onClose","header","level","dynamicContentHeight","data","modal","separator","map","EventCard","initialRating","Rating","eventId","userId","database","firebase","rating","setRating","a","ref","on","dataSnapshooot","fetchedValue","val","set","index","ids","window","reload","ratingData","item","Object","values","length","keys","indexOf","fetchData","r","orderByChild","equalTo","dataSnapshoot","userRating","forEach","points","selected","remove","onRate","UserHeader","className","disabled","multiline","photo_200","text","weight","first_name","last_name","EventAdd","position","left","bottom","background","boxShadow","fill","Filter","args","this","update","eventArray","getDistance","latitude","lat","longitude","lng","EventScan","bridge","send","then","console","log","code_data","catch","e","UserProfile","loading","setLoading","fetchedUser","setUser","fetchedEvents","setEvents","setLocation","long","nextPage","last","query","orderByKey","startAt","limitToFirst","dataSnapshot","entries","splice","threshold","loadMore","hasMore","loader","EventCardList","LocationEvents","height","padding","defaultState","center","zoom","width","geometry","options","preset","properties","hintContent","balloonContent","modules","renderToString","href","UserSmallCard","mode","vkId","after","firstName","lastName","Event","useRouteNode","route","params","propsEvent","setEvent","subscriptions","setSubscriptions","picture","setPicture","qrCode","setQrCode","storage","snapshot","getDownloadURL","url","QRCode","toString","ratingFragment","role","aria-label","history","back","backgroundImage","backgroundSize","alignItems","justifyContent","paddingBottom","borderRadius","photos","layout","flex","toLocaleString","dangerouslySetInnerHTML","__html","stretched","subscribeUserData","EventCreate","preview","setPreview","eventName","useRef","eventPrice","eventPicture","eventDescription","eventValidation","setEventValidation","defaultDate","toISOString","split","substr","eventDate","coordinates","userLocation","setUserLocation","userInfo","GEOCODER_URL","process","join","fetch","response","json","GeoObjectCollection","featureMember","GeoObject","submitEvent","push","current","valueAsNumber","createdEvent","child","put","files","owner","onValidate","valid","newValidation","get","getRef","status","objectFit","accept","controlSize","imageFile","fileReader","FileReader","onloadend","Jimp","read","result","image","resize","AUTO","getBase64Async","MIME_PNG","base64Link","readAsArrayBuffer","defaultValue","type","TABS__","icon","TabsRoot","activeStory","setActiveStory","useRouter","currentTab","tab","tabName","onStoryChange","to","currentTarget","dataset","story","tabBarComponent","data-story","tabbar","dotenv","config","App","path","AuthContext","createContext","AuthProvider","children","vkUser","setVkUser","fetchUser","app","auth","onAuthStateChanged","Provider","createRouter","routes","defaultRoute","usePlugin","browserPlugin","useHash","configureRouter","initializeApp","apiKey","projectId","databaseURL","authDomain","storageBucket","email","password","userUuid","uuidv4","fauth","createUserWithEmailAndPassword","error","code","signInWithEmailAndPassword","logIn","start","ReactDOM","render","document","getElementById","eruda"],"mappings":"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","file":"static/js/main.ad7bc0a4.chunk.js","sourcesContent":["import React from \"react\";\r\n\r\nconst Meta = () => {\r\n  return (\r\n      <meta\r\n        name=\"viewport\"\r\n        content=\"width=device-width, initial-scale=1, shrink-to-fit=no, user-scalable=no, viewport-fit=cover\"\r\n      ></meta>\r\n  );\r\n};\r\n\r\nexport default Meta;\r\n","import React from \"react\";\r\nimport PropTypes from \"prop-types\";\r\nimport { Card, Cell, Avatar } from \"@vkontakte/vkui\";\r\nimport Icon24User from \"@vkontakte/icons/dist/24/user\";\r\nimport Icon16Place from \"@vkontakte/icons/dist/16/place\";\r\nimport Icon24MoneyCircle from \"@vkontakte/icons/dist/24/money_circle\";\r\nimport { useRoute } from \"react-router5\";\r\n\r\nconst ProjectCard = (props) => {\r\n\r\n  const { event } = props;\r\n  const { router } = useRoute();\r\n\r\n  return (\r\n    <Card size=\"l\" onClick={() => { router.navigate('event', { id: event.id, event }); }}>\r\n      <Cell\r\n        before={\r\n          <Avatar size={32} src={event.user.photo ?? null}>\r\n            {event.user.photo ? null : <Icon24User />}\r\n          </Avatar>\r\n        }\r\n        size=\"l\"\r\n        description={\r\n          <div style={{ display: \"flex\" }}>\r\n            <Icon16Place />\r\n            {event.location.name}\r\n          </div>\r\n        }\r\n        asideContent={\r\n          <>\r\n            {\r\n              event.price && event.price !== 0 ? (\r\n                <div style={{ textAlign: \"center\", color: \"green\" }}>\r\n                  <Icon24MoneyCircle style={{ margin: \"0 auto\" }} />\r\n                  {Math.round(event.price)}\r\n                </div>\r\n              ) : <></>\r\n            }\r\n            <div>\r\n              {new Date(event.date).toLocaleDateString()}\r\n            </div>\r\n          </>\r\n        }\r\n        bottomContent={\r\n          <>\r\n            <div>{event.description}</div>\r\n          </>\r\n        }\r\n      >\r\n        {event.name}\r\n      </Cell>\r\n    </Card>\r\n  );\r\n};\r\n\r\nProjectCard.propTypes = {\r\n  event: PropTypes.any.isRequired,\r\n};\r\n\r\nexport default ProjectCard;\r\n","import React from \"react\";\r\nimport PropTypes from \"prop-types\";\r\nimport {\r\n  Cell,\r\n  Slider,\r\n  FormLayout\r\n} from \"@vkontakte/vkui\";\r\n\r\nexport const MAX_DISTANCE = 50 * 1000;\r\n\r\nconst FilterPanel = (props) => {\r\n\r\n  const { filterValues, onUpdate } = props;\r\n\r\n  return (\r\n    <FormLayout style={{ zIndex: 1000 }}>\r\n      <Slider\r\n        min={500}\r\n        max={MAX_DISTANCE}\r\n        step={500}\r\n        value={filterValues['location'] === null ? 1 : filterValues['location']}\r\n        onChange={(value) => {\r\n          onUpdate({ key: 'location', value: value >= MAX_DISTANCE ? null : value });\r\n        }}\r\n        top={`В радиусе ${filterValues['location'] === null ? \"∞\" : filterValues['location']} м`}\r\n      />\r\n      <Cell></Cell><Cell></Cell>\r\n    </FormLayout>\r\n  )\r\n};\r\n\r\nFilterPanel.propTypes = {\r\n  onUpdate: PropTypes.func.isRequired,\r\n};\r\n\r\nexport default FilterPanel;\r\n","import React, { useState, useEffect } from \"react\";\r\nimport PropTypes from \"prop-types\";\r\nimport {\r\n  Group,\r\n  CardGrid,\r\n  CellButton,\r\n  View,\r\n  ModalRoot,\r\n  ModalPage,\r\n  ModalPageHeader,\r\n  Title,\r\n} from \"@vkontakte/vkui\";\r\n\r\nimport Icon24Sort from \"@vkontakte/icons/dist/24/sort\";\r\n\r\nimport EventCard from \"./EventCard\";\r\nimport FilterPanel from \"./FilterPanel\";\r\n\r\nconst MAIN_MODAL = \"main-modal\";\r\n\r\nconst ProjectCardList = (props) => {\r\n  const { events, filter, setFilter } = props;\r\n  const [currentModal, setCurrentModal] = useState(null);\r\n  const [innerFilter, setInnerFilter] = useState(filter);\r\n\r\n  useEffect(() => {\r\n    setInnerFilter(filter);\r\n  }, [filter]);\r\n\r\n\r\n  const updateFilter = (data) => {\r\n    const { key, value } = data;\r\n    setInnerFilter({\r\n      ...innerFilter,\r\n      [key]: value\r\n    })\r\n  }\r\n\r\n  let filteredEvents = events.filter((element) => {\r\n    return element;\r\n  });\r\n\r\n  const filterModal = (\r\n    <ModalRoot\r\n      activeModal={currentModal}\r\n      onClose={() => {\r\n        setFilter(innerFilter);\r\n        setCurrentModal(null);\r\n      }}\r\n    >\r\n      <ModalPage\r\n        id={MAIN_MODAL}\r\n        header={<ModalPageHeader><Title level=\"2\">Фильтры</Title></ModalPageHeader>}\r\n        dynamicContentHeight\r\n      >\r\n        <FilterPanel filterValues={innerFilter} onUpdate={updateFilter} />\r\n      </ModalPage>\r\n    </ModalRoot>\r\n  );\r\n\r\n  return (\r\n    <View modal={filterModal}>\r\n      <Group\r\n        separator=\"hide\"\r\n        header={\r\n          <CellButton\r\n            before={<Icon24Sort />}\r\n            onClick={() => {\r\n              setCurrentModal(MAIN_MODAL);\r\n            }}\r\n          >\r\n            Фильтровать\r\n          </CellButton>\r\n        }\r\n      >\r\n        <CardGrid>\r\n          {filteredEvents.map((event, key) => (\r\n            <EventCard key={key} event={event} />\r\n          ))}\r\n        </CardGrid>\r\n      </Group>\r\n    </View>\r\n  );\r\n};\r\n\r\nProjectCardList.propTypes = {\r\n  events: PropTypes.array.isRequired,\r\n  filter: PropTypes.object.isRequired,\r\n  setFilter: PropTypes.func.isRequired\r\n};\r\n\r\nexport default ProjectCardList;\r\n","import React, { useEffect, useState } from \"react\";\r\nimport {\r\n  Title,\r\n  Tabs,\r\n  TabsItem\r\n} from \"@vkontakte/vkui\";\r\nimport firebase from \"firebase\";\r\nimport \"firebase/database\";\r\n\r\nexport const initialRating = [\r\n  { key: \"😊\", value: [] },\r\n  { key: \"😴\", value: [] },\r\n  { key: \"😍\", value: [] },\r\n  { key: \"🤬\", value: [] },\r\n];\r\n\r\nconst Rating = (props) => {\r\n\r\n  const { eventId, userId } = props;\r\n\r\n  const database = firebase.database();\r\n\r\n  const [rating, setRating] = useState([]);\r\n\r\n  useEffect(() => {\r\n    const fetchData = async () => {\r\n      database.ref(`rating/${eventId}/rating`).on(\"value\", dataSnapshooot => {\r\n        const fetchedValue = dataSnapshooot.val();\r\n        if (fetchedValue === null || typeof (fetchedValue) !== typeof ([])) {\r\n          database.ref(`rating/${eventId}/rating`).set(initialRating.map((element, index) => {\r\n            return { key: element.key, ids: [] }\r\n          }));\r\n          window.location.reload();\r\n        }\r\n        const ratingData = fetchedValue ? fetchedValue.map(item => {\r\n          return {\r\n            key: item.key,\r\n            value: item.ids ? Object.values(item.ids).length : 0,\r\n            set: item.ids ? Object.keys(item.ids).indexOf(`${userId}`) !== -1 : false\r\n          };\r\n        }) : initialRating;\r\n        setRating(ratingData);\r\n      });\r\n    };\r\n    if (eventId)\r\n      fetchData();\r\n  }, [userId, eventId]);\r\n\r\n  const onRate = (key) => {\r\n    rating.forEach((element, index) => {\r\n      if (element.key === key) {\r\n        database.ref(`rating/${eventId}/rating/${index}/ids/${userId}`).set(true);\r\n      } else {\r\n        database.ref(`rating/${eventId}/rating/${index}/ids/${userId}`).remove();\r\n      }\r\n    });\r\n  }\r\n\r\n  if (!eventId) {\r\n    // User profile rating\r\n    const r = {};\r\n    database.ref(`rating/`).orderByChild(\"owner\").equalTo(userId).on(\"value\", dataSnapshoot => {\r\n      const userRating = dataSnapshoot.val();\r\n      Object.values(userRating).map(item => {\r\n        item.rating.forEach(item => {\r\n          const points = Object.keys(item.ids ? item.ids : []).length;\r\n          r[item.key] = r[item.key] ? r[item.key] + points : points;\r\n        });\r\n      });\r\n    });\r\n    const rating = Object.keys(r).map(key => {\r\n      return {\r\n        key: key,\r\n        value: r[key]\r\n      }\r\n    });\r\n    return (\r\n      <Tabs>\r\n        {rating.map((item, key) => (\r\n          <TabsItem key={key}>\r\n            <Title>{item.key}</Title>\r\n            <Title>{item.value}</Title>\r\n          </TabsItem>\r\n        ))}\r\n      </Tabs>\r\n    );\r\n  }\r\n\r\n  return (\r\n    <Tabs>\r\n      {(rating ? rating : initialRating).map((item, key) => (\r\n        <TabsItem selected={item.set} key={key} onClick={() => { onRate(item.key) }}>\r\n          <Title>{item.key}</Title>\r\n          <Title>{item.value}</Title>\r\n        </TabsItem>\r\n      ))}\r\n    </Tabs>\r\n  )\r\n};\r\n\r\nexport default Rating;\r\n","import React from \"react\";\nimport { Avatar, RichCell, Title } from \"@vkontakte/vkui\";\nimport PropTypes from \"prop-types\";\n\nimport Icon24User from \"@vkontakte/icons/dist/24/user\";\n\nimport \"./UserProfile.css\";\nimport Rating from \"../components/Rating\";\n\nconst UserHeader = (props) => {\n\n  const { user } = props;\n  const userName = \"Никита Долгошеин\";\n\n  return (\n    <RichCell\n      className=\"user-profile-header\"\n      disabled\n      multiline\n      before={\n        <Avatar\n          size={72}\n          src={user !== null ? user.photo_200 : null}\n        >\n          {user === null ? <Icon24User /> : null}\n        </Avatar>\n      }\n      text={ <Rating userId={user?.id ? user.id : \"dorianmood\"} /> \n      }\n    >\n      <Title level=\"2\" weight=\"regular\">\n        {user !== null\n          ? `${user.first_name} ${user.last_name}`\n          : userName}\n      </Title>\n    </RichCell>\n  );\n};\n\nUserHeader.propTypes = {\n  rating: PropTypes.array,\n  user: PropTypes.object\n}\n\nexport default UserHeader;\n","import React from \"react\";\nimport Icon28AddOutline from \"@vkontakte/icons/dist/28/add_outline\";\nimport { Avatar } from \"@vkontakte/vkui\";\nimport { useRoute } from \"react-router5\";\n\nconst EventAdd = () => {\n\n  const { router } = useRoute();\n\n  return (\n    <div\n      style={{ position: \"fixed\", left: 24, bottom: 64, zIndex: 1 }}\n      onClick={() => router.navigate('create') }\n    >\n      <Avatar style={{ background: \"var(--button_primary_background)\" , boxShadow: \"0px 0px 10px black\"}}>\n        <Icon28AddOutline fill={\"var(--button_primary_foreground)\"} />\n      </Avatar>\n    </div>\n  );\n\n};\n\nexport default EventAdd;\n","import { getDistance } from \"geolib\";\n\nclass Filter {\n  constructor(location, date, args) {\n    this.location = location;\n    this.date = date;\n\n    this.update = this.update;\n    this.filter = this.filter;\n  }\n  update(element) {\n    this[element.key] = element.value;\n  }\n  filter (eventArray, location) {\n    // Filter fetched events\n    const filteredEvents = eventArray.filter(event => {\n      if (this.location && this.location !== null) {\n        const distanceFromMe = getDistance(\n          { latitude: event.location.lat, longitude: event.location.lng },\n          { latitude: location[0], longitude: location[1] }\n        );\n        return (distanceFromMe <= this.location);\n      }\n      return true;\n    });\n    return filteredEvents;\n  }\n}\n\nexport default Filter;","import React from \"react\";\nimport Icon28ScanViewfinderOutline from '@vkontakte/icons/dist/28/scan_viewfinder_outline';\nimport { Avatar } from \"@vkontakte/vkui\";\nimport { useRoute } from \"react-router5\";\nimport bridge from \"@vkontakte/vk-bridge\";\n\nconst EventScan = () => {\n\n  const { router } = useRoute();\n\n  const onScan = () => {\n    bridge.send(\"VKWebAppOpenCodeReader\").then(data => {\n      console.log(\"Scanned\", data);\n      router.navigate(\"event\", { id: data.code_data });\n    }).catch(e => {\n      console.log(e);\n    });\n  }\n\n  return (\n    <div\n      style={{ position: \"fixed\", left: 24, bottom: 128, zIndex: 1 }}\n      onClick={onScan}\n    >\n      <Avatar style={{ background: \"var(--button_primary_background)\", boxShadow: \"0px 0px 10px black\" }}>\n        <Icon28ScanViewfinderOutline fill={\"var(--button_primary_foreground)\"} />\n      </Avatar>\n    </div>\n  );\n\n};\n\nexport default EventScan;\n","import React, { useState, useEffect } from \"react\";\r\nimport { Panel, Spinner } from \"@vkontakte/vkui\";\r\nimport bridge from \"@vkontakte/vk-bridge\";\r\nimport firebase from \"firebase/app\";\r\nimport \"firebase/database\";\r\n\r\nimport \"./UserProfile.css\";\r\nimport EventCardList from \"../Event/EventCardList\";\r\nimport UserHeader from \"./UserHeader\";\r\nimport EventAdd from \"../components/EventAdd\";\r\nimport Filter from \"../../utils/Filter\";\r\nimport InfiniteScroll from 'react-infinite-scroller';\r\nimport EventScan from \"../components/EventScan\";\r\n\r\nconst UserProfile = (props) => {\r\n\r\n  // TODO : here we can render user related data first\r\n\r\n  // Fetch data\r\n  const database = firebase.database();\r\n  const [loading, setLoading] = useState(true);\r\n\r\n  const [fetchedUser, setUser] = useState(null);\r\n  const [fetchedEvents, setEvents] = useState([]);\r\n  const [filter, setFilter] = useState(new Filter(null, null));\r\n  const [location, setLocation] = useState([56.85, 60.6]);\r\n\r\n  /*\r\n  Fetch VK user data and save it to state.\r\n  */\r\n  useEffect(() => {\r\n    async function fetchData() {\r\n      const user = await bridge.send(\"VKWebAppGetUserInfo\");\r\n      setUser(user);\r\n    }\r\n    fetchData();\r\n  }, []);\r\n\r\n  useEffect(() => {\r\n    async function fetchData() {\r\n      const location = await bridge.send(\"VKWebAppGetGeodata\");\r\n      setLocation([location.lat, location.long]);\r\n    }\r\n    fetchData();\r\n  }, [filter]);\r\n\r\n  /*\r\n  Fetch events from firebase.\r\n  */\r\n  // TODO : make it work with filter\r\n  // may be it is better just to move all the logic inside EventList component\r\n  const nextPage = () => {\r\n    let last = fetchedEvents[fetchedEvents.length - 1];\r\n    let query = database.ref(\"events\").orderByKey();\r\n    if (fetchedEvents.length > 0) {\r\n      query = query.startAt(last.id);\r\n    }\r\n    query.limitToFirst(50).on(\"value\", dataSnapshot => {\r\n      let events = dataSnapshot.val() ? Object.entries(dataSnapshot.val()).map(e => {\r\n        return { id: e[0], ...e[1] };\r\n      }) : []; if (fetchedEvents.length > 0) events.splice(0, 1);\r\n      if (events.length > 0) {\r\n        setEvents([...fetchedEvents, ...events]);\r\n      } else if (loading) {\r\n        setLoading(false);\r\n      }\r\n    });\r\n  }\r\n\r\n  useEffect(() => {\r\n    nextPage();\r\n  }, [database]);\r\n\r\n  const filteredEvents = filter.filter(fetchedEvents, location);\r\n\r\n  return (\r\n    <Panel>\r\n      <UserHeader user={fetchedUser} />\r\n      <InfiniteScroll threshold={0} loadMore={nextPage} hasMore={loading} loader={<Spinner key={0} />}>\r\n        <EventCardList events={filteredEvents} filter={filter} setFilter={setFilter} />\r\n      </InfiniteScroll>\r\n      <EventAdd />\r\n      <EventScan />\r\n    </Panel>\r\n  );\r\n};\r\n\r\nexport default UserProfile;\r\n","import React, { useState, useEffect } from \"react\";\nimport { renderToString } from \"react-dom/server\";\nimport { Panel, Spinner, Div } from \"@vkontakte/vkui\";\nimport bridge from \"@vkontakte/vk-bridge\";\nimport firebase from \"firebase/app\";\n\nimport { YMaps, Map, Placemark, Circle } from 'react-yandex-maps';\n\nimport EventCardList from \"../Event/EventCardList\";\nimport Filter from \"../../utils/Filter\";\nimport InfiniteScroll from \"react-infinite-scroller\";\n\n\nconst LocationEvents = (props) => {\n\n  // Fetch data\n  const database = firebase.database();\n  const [loading, setLoading] = useState(true);\n\n  const [fetchedEvents, setEvents] = useState([]);\n  const [location, setLocation] = useState([56.85, 60.6]);\n  const [filter, setFilter] = useState(new Filter(null, null));\n\n  useEffect(() => {\n    async function fetchData() {\n      const location = await bridge.send(\"VKWebAppGetGeodata\");\n      setLocation([location.lat, location.long]);\n    }\n    fetchData();\n  }, []);\n\n  /*\n  Fetch events from firebase.\n  */\n  // may be it is better just to move all the logic inside EventList component\n  const nextPage = () => {\n    let last = fetchedEvents[fetchedEvents.length - 1];\n    let query = database.ref(\"events\").orderByKey();\n    if (fetchedEvents.length > 0) {\n      query = query.startAt(last.id);\n    }\n    query.limitToFirst(50).on(\"value\", dataSnapshot => {\n      let events = dataSnapshot.val() ? Object.entries(dataSnapshot.val()).map(e => {\n        return { id: e[0], ...e[1] };\n      }) : []; if (fetchedEvents.length > 0) events.splice(0, 1);\n      if (events.length > 0) {\n        setEvents([...fetchedEvents, ...events]);\n      } else if (loading) {\n        setLoading(false);\n      }\n    });\n  }\n\n  useEffect(() => {\n    nextPage();\n  }, []);\n\n  // Filter fetched events\n  const filteredEvents = filter.filter(fetchedEvents, location);\n\n  return (\n    <Panel>\n      <Div style={{ height: \"240px\", padding: 0 }}>\n        <YMaps >\n          <Map defaultState={{ center: location, zoom: 10 }} width={'100%'}>\n            <Placemark\n              geometry={location}\n              options={{ preset: \"islands#redCircleDotIcon\" }}\n              properties={{ hintContent: \"this is hint\", balloonContent: \"this is balloon\" }}\n              modules={['geoObject.addon.balloon', 'geoObject.addon.hint']}\n            />\n            {\n              filteredEvents.map((event, id) => {\n                const geometry = [event.location.lat, event.location.lng];\n                return (\n                  <Placemark\n                    key={id} geometry={geometry} modules={['geoObject.addon.balloon']}\n                    properties={{ balloonContent: renderToString(<a href={`#/event/${event.id}`}>{event.name}</a>) }}\n                  />)\n              })\n            }\n            <Circle geometry={[location, filter['location'] | 0]} />\n          </Map>\n        </YMaps>\n      </Div>\n      <InfiniteScroll threshold={0} loadMore={nextPage} hasMore={loading} loader={<Spinner key={0} />}>\n        <EventCardList events={filteredEvents} filter={filter} setFilter={setFilter} />\n      </InfiniteScroll>\n    </Panel>\n  );\n};\n\nexport default LocationEvents;\n","import React from \"react\";\nimport PropTypes from \"prop-types\";\n\nimport { Group, Header, SimpleCell, Avatar } from \"@vkontakte/vkui\";\n\nconst UserSmallCard = (props) => {\n\n  const { user } = props;\n\n  return (\n    <Group>\n      <Header mode=\"secondary\">Организатор</Header>\n      <a href={`https://vk.com/id${user.vkId}`}>\n        <SimpleCell before={<Avatar size={40} src={user.photo} after={\"textz\"} />}>{`${user.firstName} ${user.lastName}`}</SimpleCell>\n      </a>\n    </Group>\n  );\n}\n\nUserSmallCard.propTypes = {\n  user: PropTypes.any.isRequired,\n};\n\nexport default UserSmallCard;\n","import React, { useEffect, useState } from \"react\";\r\nimport { useRouteNode } from \"react-router5\";\r\nimport { PanelHeaderButton, Panel, PanelHeader, Spinner, Div, Cell, Button, Group, Header, UsersStack, PanelHeaderContent } from \"@vkontakte/vkui\";\r\nimport Icon24Back from \"@vkontakte/icons/dist/24/back\";\r\nimport Icon24MoneyCircle from \"@vkontakte/icons/dist/24/money_circle\";\r\nimport Icon24Recent from '@vkontakte/icons/dist/24/recent';\r\nimport { YMaps, Map, Placemark } from \"react-yandex-maps\";\r\nimport firebase from \"firebase\";\r\nimport \"firebase/storage\";\r\nimport bridge from \"@vkontakte/vk-bridge\";\r\nimport UserSmallCard from \"../components/UserSmallCard\";\r\nimport Rating from \"../components/Rating\";\r\nimport QRCode from \"qrcode\";\r\n\r\nconst Event = () => {\r\n  const { route } = useRouteNode('event');\r\n\r\n  const { id, event: propsEvent } = route.params;\r\n  const [event, setEvent] = useState(propsEvent);\r\n  const [user, setUser] = useState({ id: \"dorianmood\" });\r\n  const [subscriptions, setSubscriptions] = useState({});\r\n  const [picture, setPicture] = useState(\"\");\r\n  const [qrCode, setQrCode] = useState(\"\");\r\n\r\n  const database = firebase.database();\r\n  const storage = firebase.storage();\r\n\r\n  useEffect(() => {\r\n    if (!propsEvent) {\r\n      database.ref(`events/${id}`).on(\"value\", snapshot => {\r\n        setEvent(snapshot.val());\r\n      });\r\n    }\r\n    database.ref(`subscriptions/${id}`).on(\"value\", snapshot => {\r\n      setSubscriptions(snapshot.val());\r\n    });\r\n    storage.ref(`events_pictures/${id}`).getDownloadURL().then(url => {\r\n      setPicture(url);\r\n    }).catch(() => {\r\n      // This event has no picture  \r\n    });\r\n  }, [database, id, propsEvent]);\r\n\r\n  useEffect(() => {\r\n    const fetchData = async () => {\r\n      const user = await bridge.send(\"VKWebAppGetUserInfo\");\r\n      setUser(user);\r\n    }\r\n    fetchData();\r\n  }, []);\r\n\r\n  useEffect(() => {\r\n    QRCode.toString(id, (e, data) => {\r\n      setQrCode(data);\r\n    });\r\n  }, []);\r\n\r\n  if (!event) {\r\n    return <Spinner size=\"large\" />\r\n  }\r\n\r\n  const onDeleteEvent = () => {\r\n    database.ref(`events/${id}`).remove().then(() => {\r\n      console.log(\"Event removed\");\r\n      database.ref(`subscriptions/${id}`).remove().then(() => {\r\n        console.log(\"Subscriptions removed\");\r\n        window.history.back();\r\n      });\r\n    });\r\n  }\r\n\r\n  const onSubscribeEvent = () => {\r\n    const subscribeUserData = {\r\n      firstName: user.first_name,\r\n      lastName: user.last_name,\r\n      photo: user.photo_200\r\n    };\r\n    database.ref(`subscriptions/${id}/${user.id}`).set(subscribeUserData);\r\n  }\r\n\r\n  const onUnsubscribeEvent = () => {\r\n    database.ref(`subscriptions/${id}/${user.id}`).remove();\r\n  }\r\n\r\n  const ratingFragment = new Date(event.date) < new Date() ?\r\n    <Rating eventId={id} userId={user.id} /> :\r\n    <Div>Не забудте поставить рейтинг после окончания события <span role=\"img\" aria-label=\"down\">😊</span></Div>;\r\n\r\n  return (\r\n    <Panel id={id}>\r\n      <PanelHeader\r\n        left={\r\n          <PanelHeaderButton onClick={() => { window.history.back(); }}>\r\n            <Icon24Back />\r\n          </PanelHeaderButton>\r\n        }\r\n      >\r\n        <PanelHeaderContent>{event.name}</PanelHeaderContent>\r\n      </PanelHeader>\r\n\r\n      { ratingFragment }\r\n\r\n      <Div style={{ height: \"240px\", padding: 0 }}>\r\n        <YMaps>\r\n          <Map defaultState={{ center: [event.location.lat, event.location.lng], zoom: 10 }} width={'100%'}>\r\n            <Placemark geometry={[event.location.lat, event.location.lng]} options={{ preset: \"islands#geolocationIcon\" }} />\r\n          </Map>\r\n        </YMaps>\r\n      </Div>\r\n\r\n      <Group header={<Header mode=\"secondary\">Описание</Header>}>\r\n        <Cell multiline size=\"l\">\r\n          {event.description}\r\n        </Cell>\r\n      </Group>\r\n\r\n      <UserSmallCard user={event.user} />\r\n\r\n      <Group header={<Header mode=\"secondary\">Информация</Header>}>\r\n        <Div>\r\n          <div style={{\r\n            backgroundImage: `linear-gradient(rgba(0, 0, 0, 0), rgba(0, 0, 0, 0.5)), url(${picture})`,\r\n            backgroundSize: \"cover\",\r\n            height: \"200px\",\r\n            display: \"flex\",\r\n            alignItems: \"flex-end\",\r\n            justifyContent: \"center\",\r\n            paddingBottom: \"6px\",\r\n            borderRadius: 12\r\n          }}>\r\n            {\r\n              subscriptions ?\r\n                <UsersStack\r\n                  photos={Object.keys(subscriptions).map(key => subscriptions[key].photo)}\r\n                  size=\"m\"\r\n                  layout=\"vertical\"\r\n                  style={{ color: \"#fff\" }}\r\n                >{Object.keys(subscriptions).length} участников</UsersStack>\r\n                : <></>\r\n            }\r\n          </div>\r\n        </Div>\r\n        <Div style={{ display: \"flex\" }}>\r\n          <Div style={{ flex: \"1 1 auto\", display: \"flex\", justifyContent: \"center\" }}><Icon24MoneyCircle style={{ margin: \"-2px 10px 0 0\" }} fill={\"green\"} /> {event.price}</Div>\r\n          <Div style={{ flex: \"1 1 auto\", display: \"flex\", justifyContent: \"center\" }}><Icon24Recent style={{ margin: \"-2px 10px 0 0\" }} />{new Date(event.date).toLocaleString()}</Div>\r\n        </Div>\r\n\r\n        <h3 style={{ textAlign: \"center\", margin: \"10px 0 0 0\" }}><span role=\"img\" aria-label=\"down\">👇🏻</span> Сканируй событие тут! <span role=\"img\" aria-label=\"down\">👇🏻</span></h3>\r\n        <Div id=\"event-qr-code\" dangerouslySetInnerHTML={{ __html: qrCode }}></Div>\r\n\r\n        {\r\n          user && event.user.vkId === user.id ? <></> :\r\n            user && subscriptions && Object.keys(subscriptions).indexOf(`${user.id}`) !== -1 ?\r\n              <Div>\r\n                <Button stretched mode=\"outline\" style={{ padding: \"10px\" }} onClick={onUnsubscribeEvent}>Не пойду</Button>\r\n              </Div>\r\n              :\r\n              <Div>\r\n                <Button stretched mode=\"commerce\" style={{ padding: \"10px\" }} onClick={onSubscribeEvent}>Пойду</Button>\r\n              </Div>\r\n        }\r\n        { // TODO : give permission to delete only to owners.\r\n          user && user.id === event.user.vkId ?\r\n            <Div>\r\n              <Button stretched mode=\"destructive\" style={{ padding: \"10px\" }} onClick={onDeleteEvent}>Удалить</Button>\r\n            </Div> : <></>\r\n        }\r\n      </Group>\r\n    </Panel>\r\n  );\r\n};\r\n\r\nexport default Event;\r\n","import React, { useState, useEffect, useRef } from \"react\";\nimport {\n  Panel,\n  PanelHeader,\n  PanelHeaderButton,\n  Div,\n  Input,\n  Button,\n  FormLayout,\n  FormLayoutGroup,\n  Textarea,\n  File\n} from \"@vkontakte/vkui\";\nimport Icon24Back from \"@vkontakte/icons/dist/24/back\";\nimport Icon24Camera from \"@vkontakte/icons/dist/24/camera\";\nimport { YMaps, Placemark, Map } from \"react-yandex-maps\";\nimport bridge from \"@vkontakte/vk-bridge\";\nimport firebase from \"firebase/app\";\nimport \"firebase/storage\";\nimport Jimp from \"jimp\";\n\nimport { initialRating } from \"../components/Rating\";\n\nconst EventCreate = () => {\n  // TODO : fix rerendering here\n\n  const [user, setUser] = useState({\n    vkId: \"dorianmood\",\n    photo: \"\",\n    firstName: \"Developer\",\n    lastName: \"Developer\"\n  });\n  const [preview, setPreview] = useState(\"\");\n\n  const database = firebase.database();\n  const storage = firebase.storage();\n\n  // form refs to get rid of rerendering\n  const eventName = useRef();\n  const eventPrice = useRef();\n  const eventPicture = useRef();\n  const eventDescription = useRef();\n\n  // form validation variables\n  const defaultValidation = {\n    name: false,\n    picture: false,\n    price: false,\n    description: false,\n    location: false\n  };\n  const [eventValidation, setEventValidation] = useState(defaultValidation);\n\n  let dateNow = new Date();\n  let defaultDate = dateNow.toISOString().split(\".\")[0];\n  defaultDate = defaultDate.substr(0, defaultDate.length - 3);\n  const eventDate = useRef(defaultDate);\n\n  const [location, setLocation] = useState({\n    name: \"Место\",\n    coordinates: [56.83890, 60.605192]\n  });\n  const [userLocation, setUserLocation] = useState([56.83890, 60.605192]);\n\n  useEffect(() => {\n    async function fetchData() {\n      const location = await bridge.send(\"VKWebAppGetGeodata\");\n      setUserLocation([location.lat, location.long]);\n      const userInfo = await bridge.send(\"VKWebAppGetUserInfo\");\n      setUser({ vkId: userInfo.id, photo: userInfo.photo_200, firstName: userInfo.first_name, lastName: userInfo.last_name })\n    }\n    fetchData();\n  }, []);\n\n  useEffect(() => {\n    const GEOCODER_URL = `https://geocode-maps.yandex.ru/1.x/?apikey=${process.env.REACT_APP_YANDEX_KEY}&geocode=${[location.coordinates[1], location.coordinates[0]].join(',')}&format=json`;\n\n    fetch(GEOCODER_URL).then(response => response.json()).then(data => {\n      setLocation({\n        ...location,\n        name: data.response.GeoObjectCollection.featureMember[0].GeoObject.name\n      });\n    });\n  }, [location.coordinates]);\n\n  const submitEvent = async () => {\n    // Create event\n    const createdEvent = await database.ref(`events`).push(\n      {\n        name: eventName.current.value,\n        price: eventPrice.current.value,\n        date: eventDate.current.valueAsNumber,\n        description: eventDescription.current.value,\n        location: {\n          name: location.name,\n          lat: location.coordinates[0],\n          lng: location.coordinates[1]\n        },\n        user: user\n      }\n    );\n    storage.ref(\"events_pictures\").child(createdEvent.key).put(eventPicture.current.files[0]);\n    // TODO : need fix here. something goes wrong.\n    // Subscribe\n    database.ref(`subscriptions/${createdEvent.key}/${user.vkId}`).set({\n      firstName: user.firstName,\n      lastName: user.lastName,\n      photo: user.photo\n    }).then(() => console.log(\"SUBSCRIBTION CREATED\"));\n    // Create rating\n    database.ref(`rating/${createdEvent.key}`).set({\n      rating: initialRating.map(item => { return { key: item.key } }),\n      owner: user.vkId\n    }).then(() => console.log(\"RATING CREATED\"));\n  }\n\n  const onValidate = () => {\n    let valid = true;\n    const newValidation = {\n      name: eventName.current.value.length > 0 || (valid = false),\n      picture: eventPicture.current.files.length > 0 || (valid = false),\n      date: eventDate.current.value !== null || (valid = false),\n      price: eventPrice.current.value !== null || (valid = false),\n      description: eventDescription.current.value.length > 0 || (valid = false)\n    }\n    setEventValidation(newValidation);\n    return valid;\n  }\n\n  const onSubmit = () => {\n    if (!onValidate()) {\n      return false;\n    }\n    submitEvent().then(() => {\n      window.history.back();\n    });\n  }\n\n  return (\n    <Panel>\n      <PanelHeader\n        left={\n          <PanelHeaderButton onClick={() => { window.history.back(); }}>\n            {<Icon24Back />}\n          </PanelHeaderButton>\n        }\n      >\n        Опишите событие\n      </PanelHeader>\n\n\n      <FormLayout>\n        {/** MAP input */}\n        <FormLayoutGroup top={location.name}>\n          <Div style={{ height: \"150px\" }}>\n            <YMaps>\n              <Map\n                defaultState={{ center: location.coordinates, zoom: 10 }}\n                height={'150px'} width={'100%'}\n                onClick={(e) => { setLocation({ ...location, coordinates: e.get('coords') }) }}\n              >\n                <Placemark geometry={userLocation} options={{ preset: \"islands#redCircleDotIcon\" }} />\n                <Placemark geometry={location.coordinates} />\n              </Map>\n            </YMaps>\n          </Div>\n        </FormLayoutGroup>\n\n        {/** NAME input */}\n        <Input top=\"Название\" getRef={eventName} status={eventValidation.name ? \"default\" : \"error\"} onChange={onValidate} />\n        {/** PICTURE input */}\n        <Div>\n          {\n            preview !== \"\" ?\n              <img src={preview} style={{ height: \"200px\", width: \"90%\", display: \"block\", margin: \"0 auto\", objectFit: \"cover\" }} /> :\n              <></>\n          }\n        </Div>\n        <File accept=\"image/jpeg,image/x-png\" top=\"Загрузите фото\" getRef={eventPicture} before={<Icon24Camera />} controlSize=\"l\" onChange={() => {\n          const imageFile = eventPicture?.current?.files[0];\n          if (imageFile) {\n            const fileReader = new FileReader();\n            fileReader.onloadend = () => {\n              Jimp.read(fileReader.result).then(image => {\n                image.resize(Jimp.AUTO, 1080);\n                image.getBase64Async(Jimp.MIME_PNG).then(base64Link => {\n                  setPreview(base64Link);\n                });\n                // push image to firebase storage here\n              });\n            }\n            fileReader.readAsArrayBuffer(imageFile);\n          }\n        }} status={eventValidation.picture ? \"default\" : \"error\"}>\n          Открыть галерею\n        </File>\n        {/** DATE input */}\n        <Input top=\"Дата\" getRef={eventDate} min={defaultDate} defaultValue={defaultDate} type=\"datetime-local\" status={eventValidation.date ? \"default\" : \"error\"} onChange={onValidate} />\n        {/** PRICE input */}\n        <Input top=\"Цена\" getRef={eventPrice} type=\"number\" defaultValue={0} status={eventValidation.price ? \"default\" : \"error\"} onChange={onValidate} />\n        {/** DESCRIPTION input */}\n        <Textarea top=\"Описание\" getRef={eventDescription} defaultValue={0} status={eventValidation.description ? \"default\" : \"error\"} onChange={onValidate} />\n\n        <Button type=\"submit\" size=\"xl\" onClick={onSubmit}>Создать</Button>\n\n      </FormLayout>\n    </Panel>\n  );\n\n};\n\nexport default EventCreate;\n","import React, { useState, useEffect } from \"react\";\r\nimport { useRouter, useRoute } from \"react-router5\";\r\nimport View from \"@vkontakte/vkui/dist/components/View/View\";\r\nimport \"@vkontakte/vkui/dist/vkui.css\";\r\nimport { Tabbar, TabbarItem, Epic } from \"@vkontakte/vkui\";\r\n\r\nimport Icon28BombOutline from \"@vkontakte/icons/dist/28/bomb_outline\";\r\nimport Icon28PlaceOutline from \"@vkontakte/icons/dist/28/place_outline\";\r\n\r\nimport UserProfile from \"../UserProfile/UserProfile\";\r\nimport LocationEvents from \"../LocationEvents/LocationEvents\";\r\nimport Event from \"../Event/Event\";\r\nimport EventCreate from \"../components/EventCreate\";\r\n\r\nconst TABS__ = [\r\n  {\r\n    id: \"me\",\r\n    text: \"Мои\",\r\n    icon: <Icon28BombOutline />\r\n  },\r\n  {\r\n    id: \"location\",\r\n    text: \"Рядом\",\r\n    icon: <Icon28PlaceOutline />\r\n  }\r\n]\r\n\r\nconst TabsRoot = () => {\r\n  const { route } = useRoute();\r\n  const [activeStory, setActiveStory] = useState(null);\r\n  const router = useRouter();\r\n  const currentTab = TABS__.filter(tab => tab.id === route.name)[0];\r\n  const tabName = currentTab ? currentTab.id : TABS__[0].id;\r\n\r\n  useEffect(() => {\r\n    setActiveStory(tabName);\r\n  }, [tabName]);\r\n\r\n  if (route.name === \"event\") {\r\n    return (\r\n      <Event />\r\n    );\r\n  } else if (route.name === \"create\") {\r\n    return (\r\n      <EventCreate />\r\n    );\r\n  }\r\n\r\n\r\n  const onStoryChange = (e) => {\r\n    const to = e.currentTarget.dataset.story;\r\n    router.navigate(to);\r\n    setActiveStory(to);\r\n  };\r\n\r\n  const tabBarComponent = (\r\n    <Tabbar>\r\n      {TABS__.map((element, index) =>\r\n        <TabbarItem\r\n          onClick={onStoryChange}\r\n          selected={activeStory === element.id}\r\n          data-story={element.id}\r\n          text={element.text}\r\n          key={index}\r\n        >\r\n          {element.icon}\r\n        </TabbarItem>\r\n      )}\r\n    </Tabbar>\r\n  );\r\n\r\n  return (\r\n    <Epic\r\n      activeStory={activeStory}\r\n      tabbar={\r\n        tabBarComponent\r\n      }\r\n    >\r\n      <View id=\"me\" key=\"0\">\r\n        <UserProfile />\r\n      </View>\r\n      <View id=\"location\" key=\"1\">\r\n        <LocationEvents />\r\n      </View>\r\n    </Epic>\r\n  );\r\n};\r\n\r\nexport default TabsRoot;\r\n","import React from \"react\";\nimport \"@vkontakte/vkui/dist/vkui.css\";\nimport dotenv from \"dotenv\";\n\nimport Meta from \"./components/Meta\";\nimport TabsRoot from \"./Main/TabsRoot\";\n\ndotenv.config();\n\nconst App = () => {\n\n  return (\n    <>\n      <Meta />\n\n      <TabsRoot />\n    </>\n  );\n};\n\nexport default App;\n","export default [\r\n  { name: \"main\", path: \"/\" },\r\n  { name: \"me\", path: \"/me\" },\r\n  { name: \"friends\", path: \"/friends\" },\r\n  { name: \"location\", path: \"/location\" },\r\n  { name: \"event\", path: \"/event/:id\" },\r\n  { name: \"user\", path: \"/user/:id\" },\r\n  { name: \"create\", path: \"/create\" }\r\n];\r\n","import React, { createContext, useState, useEffect } from \"react\";\nimport firebase from \"firebase\";\nimport bridge from \"@vkontakte/vk-bridge\";\n\nexport const AuthContext = createContext();\n\nconst AuthProvider = ({ children }) => {\n\n  const [user, setUser] = useState();\n  const [vkUser, setVkUser] = useState();\n\n  useEffect(() => {\n    const fetchUser = async () => {\n      const user = await bridge.send(\"VKWebAppGetUserInfo\");\n      console.log(\"USER AUTH : \", user);\n\n      setVkUser(user);\n    }\n    fetchUser();\n  }, []);\n\n  useEffect(() => {\n    const app = firebase.app();\n    app.auth().onAuthStateChanged((user) => {\n      setUser(user);\n    })\n  }, []);\n\n  console.log(\"USER AUTH : \", vkUser);\n\n  return (\n    <AuthContext.Provider value={user}>\n      {children}\n    </AuthContext.Provider>\n  );\n}\n\nexport default AuthProvider;","import \"core-js/features/map\";\nimport \"core-js/features/set\";\n\nimport React from \"react\";\nimport ReactDOM from \"react-dom\";\n\nimport { RouterProvider } from \"react-router5\";\n\nimport bridge from \"@vkontakte/vk-bridge\";\n\nimport firebase from \"firebase/app\";\nimport \"firebase/auth\";\n\nimport { v4 as uuidv4 } from \"uuid\";\n\nimport App from \"./panels/App\";\nimport configureRouter from \"./create-router\";\nimport AuthProvider from \"./auth/AuthProvider\";\n\n// Init VK  Mini App\nbridge.send(\"VKWebAppInit\");\n\nconst router = configureRouter();\n\n// Firebase Config\nconst config = {\n  apiKey: process.env.REACT_APP_API_KEY,\n  projectId: process.env.REACT_APP_PROJECT_ID,\n  databaseURL: process.env.REACT_APP_DATABASE_URL,\n  authDomain: process.env.REACT_APP_AUTH_DOMAIN,\n  storageBucket: process.env.REACT_APP_STORAGE_BUCKET_URL\n};\nfirebase.initializeApp(config);\n\nconst logIn = async () => {\n  const storage = await bridge.send(\"VKWebAppStorageGet\", {\n    keys: [\n      \"userUuid\"\n    ]\n  });\n  const user = await bridge.send(\"VKWebAppGetUserInfo\");\n\n  let email = user.id;\n  let password = storage.keys[0].value;\n\n  // For new users generate and\n  // save unique userId here\n  if (!password) {\n    const userUuid = uuidv4();\n    password = userUuid;\n    await bridge\n      .send(\"VKWebAppStorageSet\", { key: \"userUuid\", value: userUuid })\n      .catch(e => console.log(e));\n  }\n\n  let fauth = firebase.auth();\n\n  fauth.createUserWithEmailAndPassword(`${email}@vk.com`, password).then((e) => {\n    console.log(\"create user : OK\");\n  }).catch((e) => {\n    console.error(e.code);\n  }).then(() => {\n    fauth.signInWithEmailAndPassword(`${email}@vk.com`, password).then((e) => {\n      console.log(\"login : OK\");\n    }).catch((e) => {\n      console.log(e.code);\n    })\n  });\n}\n\nlogIn();\n\nrouter.start(() => {\n  ReactDOM.render(\n    <AuthProvider>\n      <RouterProvider router={router}>\n        <App router={router} />\n      </RouterProvider>\n    </AuthProvider>\n    ,\n    document.getElementById(\"root\")\n  );\n});\n\n//if (process.env.NODE_ENV === \"development\") {\nimport(\"./eruda\").then((eruda) => { }); //runtime download\n//}\n","import createRouter from \"router5\";\r\nimport browserPlugin from \"router5-plugin-browser\";\r\nimport routes from \"./routes\";\r\n\r\nexport default function configureRouter() {\r\n  const router = createRouter(routes, {\r\n    defaultRoute: \"me\",\r\n  });\r\n\r\n  router.usePlugin(\r\n    browserPlugin({\r\n      useHash: true,\r\n    })\r\n  );\r\n\r\n  return router;\r\n}\r\n"],"sourceRoot":""}